<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="utf-8">
		<title>CLIP Demo</title>

		<!-- App CSS -->
		<link rel="stylesheet" href="./css/app.min.css">

		<!-- App scripts -->
		<!-- <script src="./js/app.min.js"></script> -->
		<script src="./js/alt.js"></script>
		<script src="./js/loading-handler.js"></script>
		<script src="./js/video.js"></script>
		<script src="./js/scene.js"></script>
		<script src="./js/vertical-slider.js"></script>
		<script src="./js/player.js"></script>
	</head>
	<body>
		<div id="player" class="player">
			<!-- Everything that happens before the content has loaded -->
			<div class="full pre">
				<!-- Background image / fake video preload -->
				<div class="full background fade hidden">
					<div class="bg-content fade blurred">
						<!-- Image that is displayed before any video has loaded -->
						<img class="full bg-background" />

						<!-- First video that is loaded -->
						<div class="full fake-video"></div>
					</div>

					<!-- Thumbnail image -->
					<img class="full bg-thumb fade" />
				</div>

				<!-- Loading screen controls, interactive content -->
				<div class="full loading">
					<!-- Loading text and -bar -->
					<div class="full fade hidden loading-text">
						<!-- A div to keep the content as large as it needs to be -->
						<div>
							<!-- Text placement -->
							<h2></h2>

							<!-- Loading bar wrapper -->
							<div class="loading-bar-wrapper">
								<div class="loading-bar"></div>
							</div>
						</div>
					</div>

					<!-- Play button -->
					<div class="full fade hidden loading-button">
						<button class="icon-text large" name="load">Press to load</button>
					</div>

					<!-- Noscript message -->
					<noscript>
						<div class="full fade loading-no-javascript">
								<h3>Please <a href="https://www.enable-javascript.com/" target="_blank">enable JavaScript</a> to support the HTML5 player.</h3>
						</div>
					</noscript>
				</div>
			</div>

			<!-- Everything that happens after loading -->
			<!-- TODO -->
			<div class="full post fade blurred hidden">
				<!-- Where the videos will be placed -->
				<div class="full videos"></div>

				<!-- User controls -->
				<div class="full">
					<div class="full fade controls noselect">
						<div class="row">
							<div class="col controls-nw"></div>
							<div class="col mid controls-n"></div>
							<div class="col controls-ne"></div>
						</div>
						<div class="row mid">
							<div class="col controls-w"></div>
							<div class="col mid controls-c"></div>
							<div class="col controls-e"></div>
						</div>
						<div class="row">
							<div class="col controls-sw"></div>
							<div class="col mid controls-s"></div>
							<div class="col controls-se"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script>
			// TODO: thumb should be shown regardless, when the video is loading. In case there isn't a thumb, we use the first frame instead.
			// TODO: bg should be just for the background, and should be a separate field altogether.
			// TODO:s for the video:
			// 1. Render layers together to reduce z-combine noise
			// 2. Make loops more tight
			// 3. Revise focus ico's z curves (it clips the grid, and doesn't move along it at the start)
			// 4. Remove noise from the glow (it doesn't loop)
			// 5. Retime the movement transitions (I know it's a big edit)
			// 6. "make it look good"

			player.load({
				source:{
					"intro_video":"./demo/intro.mp4",
					"loop1_video":"./demo/loop1.mp4",
					"trans1_video":"./demo/trans1.mp4",
					"loop2_video":"./demo/loop2.mp4",
					"trans2_video":"./demo/trans2.mp4",
					"loop3_video":"./demo/loop3.mp4",
					"trans3_video":"./demo/trans3.mp4",
					"loop4_video":"./demo/loop4.mp4",
					"trans4b_video":"./demo/loop4b.mp4",
					"trans4_video":"./demo/trans4.mp4",
					"loop5_video":"./demo/loop5.mp4",
					"trans5_video":"./demo/trans5.mp4",
					"loop6_video":"./demo/loop6.mp4",
					"outro_video":"./demo/outro.mp4"
				},
				config:{
					bg:"./demo/bg.png",
					// thumb:"./demo/thumb.png"
				},
				struct:{
					start:"intro",
					scenes:{
						"intro":{
							"play":"intro_video",
							"next":"loop1"
						},
						"loop1":{
							"type":"loop",
							"play":"loop1_video",
							"controls":[
								{
									"type":"button",
									"scene":"trans1",
									"text":"> FOCUS <",
									"delay":100
								}
							]
						},
						"trans1":{
							"play":"trans1_video",
							"next":"loop2"
						},
						"loop2":{
							"type":"loop",
							"play":"loop2_video",
							"controls":[
								{
									"type":"button",
									"scene":"trans2",
									"text":"> EXPAND <",
									"delay":200
								}
							]
						},
						"trans2":{
							"play":"trans2_video",
							"next":"loop3"
						},
						"loop3":{
							"type":"loop",
							"play":"loop3_video",
							"controls":[
								{
									"type":"button",
									"scene":"trans3",
									"text":"> SEEK <",
									"delay":150
								}
							]
						},
						"trans3":{
							"play":"trans3_video",
							"next":"loop4"
						},
						"loop4":{
							"type":"loop",
							"play":"loop4_video",
							"controls":[
								{
									"type":"button",
									"scene":"trans4b",
									"text":"> ROTATE <",
									"delay":200
								},
								{
									"type":"button",
									"scene":"trans4",
									"text":"> DEPLOY <",
									"delay":200
								}
							]
						},
						"trans4b":{
							"play":"trans4b_video",
							"next":"loop4"
						},
						"trans4":{
							"play":"trans4_video",
							"next":"loop5"
						},
						"loop5":{
							"type":"loop",
							"play":"loop5_video",
							"controls":[
								{
									"type":"button",
									"scene":"trans5",
									"text":"> LOCK <",
									"delay":350
								}
							]
						},
						"trans5":{
							"play":"trans5_video",
							"next":"loop6"
						},
						"loop6":{
							"type":"loop",
							"play":"loop6_video",
							"controls":[
								{
									"type":"button",
									"scene":"outro",
									"text":"> GO <",
									"delay":1050
								}
							]
						},
						"outro":{
							"play":"outro_video",
							"next":"end"
						},
						"end":{
							"type":"empty",
							"controls":[
								{
									"type":"control-replay",
									"location":"c"
								}
							]
						}
					}
				}
			});

			// player.load({
			// 	"start":"intro",
			// 	"bg":"./demo/bg.png",
			// 	"thumb":"./demo/thumb.png",
			// 	"options":[
			// 		{"type":"control-pause","location":"sw"},
			// 		{"type":"control-speed","location":"sw","min":0.5,"max":3,"default":1},
			// 		{"type":"control-hide","location":"se"},
			// 		{"type":"control-fullscreen","location":"se"}
			// 	],
			// 	"ids":{
			// 		"intro_video":"./demo/intro.mp4",
			// 		"loop1_video":"./demo/loop1.mp4",
			// 		"trans1_video":"./demo/trans1.mp4",
			// 		"loop2_video":"./demo/loop2.mp4",
			// 		"trans2_video":"./demo/trans2.mp4",
			// 		"loop3_video":"./demo/loop3.mp4",
			// 		"trans3_video":"./demo/trans3.mp4",
			// 		"loop4_video":"./demo/loop4.mp4",
			// 		"trans4b_video":"./demo/loop4b.mp4",
			// 		"trans4_video":"./demo/trans4.mp4",
			// 		"loop5_video":"./demo/loop5.mp4",
			// 		"trans5_video":"./demo/trans5.mp4",
			// 		"loop6_video":"./demo/loop6.mp4",
			// 		"outro_video":"./demo/outro.mp4"
			// 	},
			// 	"scene":{
			// 		"intro":{
			// 			"videos":["intro_video"],
			// 			"next":"loop1"
			// 		},
			// 		"loop1":{
			// 			"type":"loop",
			// 			"videos":["loop1_video"],
			// 			"controls":[
			// 				{
			// 					"type":"button",
			// 					"scene":"trans1",
			// 					"text":"> FOCUS <",
			// 					"delay":100
			// 				}
			// 			]
			// 		},
			// 		"trans1":{
			// 			"videos":["trans1_video"],
			// 			"next":"loop2"
			// 		},
			// 		"loop2":{
			// 			"type":"loop",
			// 			"videos":["loop2_video"],
			// 			"controls":[
			// 				{
			// 					"type":"button",
			// 					"scene":"trans2",
			// 					"text":"> EXPAND <",
			// 					"delay":200
			// 				}
			// 			]
			// 		},
			// 		"trans2":{
			// 			"videos":["trans2_video"],
			// 			"next":"loop3"
			// 		},
			// 		"loop3":{
			// 			"type":"loop",
			// 			"videos":["loop3_video"],
			// 			"controls":[
			// 				{
			// 					"type":"button",
			// 					"scene":"trans3",
			// 					"text":"> SEEK <",
			// 					"delay":150
			// 				}
			// 			]
			// 		},
			// 		"trans3":{
			// 			"videos":["trans3_video"],
			// 			"next":"loop4"
			// 		},
			// 		"loop4":{
			// 			"type":"loop",
			// 			"videos":["loop4_video"],
			// 			"controls":[
			// 				{
			// 					"type":"button",
			// 					"scene":"trans4b",
			// 					"text":"> ROTATE <",
			// 					"delay":200
			// 				},
			// 				{
			// 					"type":"button",
			// 					"scene":"trans4",
			// 					"text":"> DEPLOY <",
			// 					"delay":200
			// 				}
			// 			]
			// 		},
			// 		"trans4b":{
			// 			"videos":["trans4b_video"],
			// 			"next":"loop4"
			// 		},
			// 		"trans4":{
			// 			"videos":["trans4_video"],
			// 			"next":"loop5"
			// 		},
			// 		"loop5":{
			// 			"type":"loop",
			// 			"videos":["loop5_video"],
			// 			"controls":[
			// 				{
			// 					"type":"button",
			// 					"scene":"trans5",
			// 					"text":"> LOCK <",
			// 					"delay":350
			// 				}
			// 			]
			// 		},
			// 		"trans5":{
			// 			"videos":["trans5_video"],
			// 			"next":"loop6"
			// 		},
			// 		"loop6":{
			// 			"type":"loop",
			// 			"videos":["loop6_video"],
			// 			"controls":[
			// 				{
			// 					"type":"button",
			// 					"scene":"outro",
			// 					"text":"> GO <",
			// 					"delay":1050
			// 				}
			// 			]
			// 		},
			// 		"outro":{
			// 			"videos":["outro_video"],
			// 			"next":"end"
			// 		},
			// 		"end":{
			// 			"type":"empty",
			// 			"controls":[
			// 				{
			// 					"type":"control-replay",
			// 					"location":"c"
			// 				}
			// 			]
			// 		}
			// 	}
			// });
		</script>
		<script type="text/javascript">
			// HACK: This is probably the most sinful act I have ever done.
			// In order to improve playback speeds, we run some intervals in the background
			// doing pretty much nothing, and as the CPU usage of the browser window rises,
			// the video playback becomes smoother. I'm so sorry.
      for (var i=0;i<220;i++){
        setInterval(function(){
          var t = 0;
          for (var g=0;g<500;g++) t++;
        },1);
      }
    </script>
	</body>
</html>
