<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="utf-8">
		<title>CLIP Demo</title>

		<!-- App CSS -->
		<link rel="stylesheet" href="./css/app.min.css">

		<!-- App scripts -->
		<!-- TODO: Remove alt dependency / shrink alt -->
		<!-- TODO: Remove vertical slider as a separate module (more like file)? -->
		<script src="./js/alt.js"></script>
		<script src="./js/vertical-slider.js"></script>
		<script src="./js/player.js"></script>
	</head>
	<body>
		<div id="player" class="player">
			<!-- Everything that happens before the content has loaded -->
			<div class="full pre">
				<!-- Background image / fake video preload -->
				<div class="full background">
					<!-- Image that is displayed before any video has loaded -->
					<img class="full blurred bg-thumb" />

					<!-- First video that is loaded -->
					<video class="full fade blurred hidden fake"></video>
				</div>

				<!-- Loading screen controls, interactive content -->
				<div class="full loading">
					<!-- Loading text and -bar -->
					<div class="full fade hidden loading-text">
						<!-- A div to keep the content as large as it needs to be -->
						<div>
							<!-- Text placement -->
							<h2></h2>

							<!-- Loading bar wrapper -->
							<div class="loading-bar-wrapper">
								<div class="loading-bar"></div>
							</div>
						</div>
					</div>

					<!-- Play button -->
					<div class="full fade hidden loading-button">
						<button class="icon-text" name="load">Press to load</button>
					</div>

					<!-- Noscript message -->
					<noscript>
						<div class="full fade loading-no-javascript">
								<h3>Please <a href="https://www.enable-javascript.com/" target="_blank">enable JavaScript</a> to support the HTML5 player.</h3>
						</div>
					</noscript>
				</div>
			</div>

			<!-- Everything that happens after loading -->
			<!-- TODO -->
			<div class="full post hidden">
				<!-- Where the videos will be placed -->
				<div class="full videos"></div>

				<!-- User controls -->
				<div class="full">
					<div class="full fade controls noselect">
						<div class="row">
							<div class="col controls-nw"></div>
							<div class="col mid controls-n"></div>
							<div class="col controls-ne"></div>
						</div>
						<div class="row mid">
							<div class="col controls-w"></div>
							<div class="col mid controls-c"></div>
							<div class="col controls-e"></div>
						</div>
						<div class="row">
							<div class="col controls-sw"></div>
							<div class="col mid controls-s"></div>
							<div class="col controls-se"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script>
			// TODO: This shouldn't be necessarily needed
			player.attach($('#player'));

			// TODO: Make this more intuitive, and clean it up
			player.load({
				"start":"intro",
				"options":[
					{"type":"control-pause","location":"sw"},
					{"type":"control-speed","location":"sw","min":0.5,"max":3,"default":1},
					{"type":"control-hide","location":"se"},
					{"type":"control-fullscreen","location":"se"}
				],
				"ids":{
					"intro_video":"./demo/introfocus0000-0300.mkv",
					"loop1_video":"./demo/focusrotateloop0301-0420.mkv",
					"trans1_video":"./demo/aligngrid0421-0720.mkv",
					"loop2_video":"./demo/rotateloop0721-0840.mkv",
					"trans2_video":"./demo/expand0841-1160.mkv",
					"loop3_video":"./demo/expandedloop1161-1240.mkv",
					"trans3_video":"./demo/focusinnertriangle1241-1390.mkv",
					"loop4_video":"./demo/triangleclosedloop1391-1460.mkv",
					"trans4b_video":"./demo/spintriangleloop1461-1510.mkv",
					"trans4_video":"./demo/expandTriangle1511-1610.mkv",
					"loop5_video":"./demo/triangleopenloop-fix1611-1640.mp4",
					"trans5_video":"./demo/locktriangle1641-1840.mkv",
					"loop6_video":"./demo/finalwait1841-1880.mkv",
					"outro_video":"./demo/hyperspeed1881-2000.mkv"
				},
				"scene":{
					"intro":{
						"videos":["intro_video"],
						"next":"loop1"
					},
					"loop1":{
						"type":"loop",
						"videos":["loop1_video"],
						"controls":[
							{
								"type":"button",
								"scene":"trans1",
								"text":"> FOCUS <",
								"delay":100
							}
						]
					},
					"trans1":{
						"videos":["trans1_video"],
						"next":"loop2"
					},
					"loop2":{
						"type":"loop",
						"videos":["loop2_video"],
						"controls":[
							{
								"type":"button",
								"scene":"trans2",
								"text":"> EXPAND <",
								"delay":200
							}
						]
					},
					"trans2":{
						"videos":["trans2_video"],
						"next":"loop3"
					},
					"loop3":{
						"type":"loop",
						"videos":["loop3_video"],
						"controls":[
							{
								"type":"button",
								"scene":"trans3",
								"text":"> CHOOSE <",
								"delay":150
							}
						]
					},
					"trans3":{
						"videos":["trans3_video"],
						"next":"loop4"
					},
					"loop4":{
						"type":"loop",
						"videos":["loop4_video"],
						"controls":[
							{
								"type":"button",
								"scene":"trans4b",
								"text":"> ROTATE <",
								"delay":200
							},
							{
								"type":"button",
								"scene":"trans4",
								"text":"> DEPLOY <",
								"delay":200
							}
						]
					},
					"trans4b":{
						"videos":["trans4b_video"],
						"next":"loop4"
					},
					"trans4":{
						"videos":["trans4_video"],
						"next":"loop5"
					},
					"loop5":{
						"type":"loop",
						"videos":["loop5_video"],
						"controls":[
							{
								"type":"button",
								"scene":"trans5",
								"text":"> LOCK <",
								"delay":350
							}
						]
					},
					"trans5":{
						"videos":["trans5_video"],
						"next":"loop6"
					},
					"loop6":{
						"type":"loop",
						"videos":["loop6_video"],
						"controls":[
							{
								"type":"button",
								"scene":"outro",
								"text":"> GO <",
								"delay":1050
							}
						]
					},
					"outro":{
						"videos":["outro_video"],
						"next":"end"
					},
					"end":{
						"type":"empty",
						"controls":[
							{
								"type":"control-replay",
								"location":"c"
							}
						]
					}
				}
			});
		</script>
		<script type="text/javascript">
			// HACK: This is probably the most sinful act I have ever done.
			// In order to improve playback speeds, we run some intervals in the background
			// doing pretty much nothing, and as the CPU usage of the browser window rises,
			// the video playback becomes smoother. I'm so sorry.
      for (var i=0;i<220;i++){
        setInterval(function(){
          var t = 0;
          for (var g=0;g<500;g++) t++;
        },1);
      }
    </script>
	</body>
</html>
